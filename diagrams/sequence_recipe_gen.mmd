sequenceDiagram
    actor dev as Developer
    participant api as CookItUpAPI
    participant recipe_gen as Recipe Generator
    participant nutrition as Nutrition
    participant extract as Parse
    participant edamam as EDAMAM API
    
    participant mongo_helper as Mongo Helper

    dev->>+api: HTTP POST /generate_recipe with ingredients
    api->>+recipe_gen: recipe_generation_function(ingredients)
    alt Recipe Generated
        recipe_gen->>+nutrition: get_nutrition(generated_ingredients)
        
        nutrition->>+extract: parse_ingredients(ingredients_list)
        extract-->>-nutrition: return ingredient_objects_list
        
        nutrition->>+mongo_helper: get_ingredients_list_nutrition(ingredient)
        mongo_helper-->>-nutrition: return ingredients_with_nutrition and ingredients_to_search
        
        nutrition->>nutrition: request_nutrition_from_api(ingredients_to_search)
        activate nutrition
        nutrition->>+edamam: HTTP GET /nutrition-data | with ingredient string
        edamam-->>-nutrition: nutritional info response
        nutrition->>+extract: parse_recipe_data(response.json())
        extract-->>-nutrition: return parsed ingredients list
        deactivate nutrition

        nutrition->>mongo_helper: mongo_helper.insert_many_ingredients(missing_ingredients_for_db)
        nutrition-->>-recipe_gen: nutrition data
        recipe_gen->>+mongo_helper: insert_recipe(recipe)
        mongo_helper-->>-recipe_gen: return recipe_id for inserted recipe
        recipe_gen-->>-api: Generated recipe with<br>nutrition and recipe_id
        api-->>-dev: Return response to the client
    else Invalid Recipe
        activate api
        activate recipe_gen
        recipe_gen-->>api: Failed to generate recipe
        deactivate recipe_gen
        api-->>dev: Notify developer of failure
        deactivate api
    end
